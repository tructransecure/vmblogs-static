{"id":799,"date":"2014-12-18T13:07:56","date_gmt":"2014-12-18T06:07:56","guid":{"rendered":"http:\/\/vmblogs.vn\/?p=799"},"modified":"2014-12-30T15:13:23","modified_gmt":"2014-12-30T08:13:23","slug":"bao-mat-tuong-lua-voi-apf","status":"publish","type":"post","link":"http:\/\/vmblogs.vn\/bao-mat-tuong-lua-voi-apf\/","title":{"rendered":"B\u1ea3o m\u1eadt t\u01b0\u1eddng l\u1eeda v\u1edbi APF (Advanced Policy Firewall)"},"content":{"rendered":"<p><span style=\"color: #0000ff;\"><strong>B\u1ea3o m\u1eadt t\u01b0\u1eddng l\u1eeda v\u1edbi APF (Advanced Policy Firewall)<\/strong><\/span><\/p>\n<p>Trong ph\u1ea7n tr\u01b0\u1edbc ch\u00fang ta \u0111\u00e3 n\u00f3i v\u1ec1 v\u1ea5n \u0111\u1ec1 b\u1ea3o m\u1eadt SSH, tuy nhi\u00ean ch\u1ec9 m\u1ed9t m\u00ecnh SSH th\u00f4i l\u00e0 kh\u00f4ng \u0111\u1ee7, t\u01b0\u1eddng l\u1eeda c\u0169ng r\u1ea5t quan tr\u1ecdng. T\u01b0\u1eddng l\u1eeda \u0111\u00f3ng vai tr\u00f2 l\u00e1 ch\u1eafn cho server c\u1ee7a b\u1ea1n tr\u00e1nh kh\u1ecfi c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng t\u1eeb m\u00f4i tr\u01b0\u1eddng Internet.<\/p>\n<p>Trong b\u00e0i n\u00e0y m\u00ecnh s\u1ebd h\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng APF (Advanced Policy Firewall) l\u00e0m t\u01b0\u1eddng l\u1eeda cho h\u1ec7 th\u1ed1ng VPS Linux (CentOS)<\/p>\n<p>APF theo nh\u01b0 t\u00ean g\u1ecdi \u0111\u00e3 th\u1ea5y l\u00e0 m\u1ed9t ph\u1ea7n m\u1ec1m ch\u1ea1y tr\u00ean t\u01b0\u1eddng l\u1eeda m\u1eb7c \u0111\u1ecbnh c\u1ee7a h\u1ec7 th\u1ed1ng (netfilter) v\u00e0 b\u1ed5 sung c\u00e1c t\u00ednh n\u0103ng n\u00e2ng cao \u0111\u1ec3 b\u1ea3o v\u1ec7 h\u1ec7 th\u1ed1ng.<\/p>\n<p>\u0110\u1ec3 n\u1eafm r\u00f5 h\u01a1n v\u1ec1 APF c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 truy c\u1eadp website <a title=\"RFXN\" href=\"http:\/\/www.rfxn.com\/\" target=\"_blank\">http:\/\/www.rfxn.com\/<\/a> \u0111\u1ec3 t\u00ecm hi\u1ec3u v\u1ec1 APF c\u0169ng nh\u01b0 c\u00e1c c\u00f4ng c\u1ee5 kh\u00e1c.<\/p>\n<p><strong>C\u00e0i \u0111\u1eb7t v\u00e0 c\u1ea5u h\u00ecnh:<\/strong><\/p>\n<p>\u0110\u1ec3 c\u00e0i \u0111\u1eb7t APF ch\u00fang ta ti\u1ebfn h\u00e0nh t\u1ea3i APF t\u1eeb website tr\u00ean d\u00f9ng l\u1ec7nh<\/p>\n<p style=\"padding-left: 30px;\"><em>wget http:\/\/www.rfxn.com\/downloads\/apf-current.tar.gz<\/em><\/p>\n<p>trong \u0111\u00f3 wget l\u00e0 l\u1ec7nh t\u1ea3i t\u1eadp tin t\u1eeb internet v\u00e0 http:\/\/www.rfxn.com\/downloads\/apf-current.tar.gz l\u00e0 \u0111\u01b0\u1eddng d\u1eabn c\u1ee7a t\u1eadp tin c\u1ea7n t\u1ea3i.<\/p>\n<p>Sau khi t\u1ea3i xong b\u1ea1n g\u00f5 l\u1ec7nh<\/p>\n<p style=\"padding-left: 30px;\"><em>tar xzvf apf.current.tar.gz<\/em><\/p>\n<p>\u0111\u1ec3 ti\u1ebfn h\u00e0nh gi\u1ea3i n\u00e9n APF<\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-1.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-802\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-1-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-1\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-1-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-1.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>Truy c\u1eadp v\u00e0o th\u01b0 m\u1ee5c v\u1eeba gi\u1ea3i n\u00e9n v\u00e0 ch\u1ea1y l\u1ec7nh<\/p>\n<p style=\"padding-left: 30px;\"><em>.\/install.sh<\/em><\/p>\n<p>\u0111\u1ec3 ti\u1ebfn h\u00e0nh c\u00e0i \u0111\u1eb7t.<\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-2.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-803\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-2-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-2\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-2-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-2.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>Sau khi \u0111\u00e3 c\u00e0i \u0111\u1eb7t xong ch\u00fang ta ti\u1ebfn h\u00e0nh c\u1ea5u h\u00ecnh APF. \u0110\u1ec3 c\u1ea5u h\u00ecnh ch\u00fang ta ch\u1ea1y l\u1ec7nh sau<\/p>\n<p style=\"padding-left: 30px;\"><em>nano \/etc\/apf\/conf.apf<\/em><\/p>\n<p>D\u1eddi con tr\u1ecf \u0111\u1ebfn Reactive Address Blocking v\u00e0 thay \u0111\u1ed5i gi\u00e1 tr\u1ecb RAB th\u00e0nh 1<\/p>\n<p><span style=\"text-decoration: underline;\">RAB=&#8221;1&#8243;<\/span><\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-3.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-804\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-3-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-3\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-3-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-3.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>T\u01b0\u01a1ng t\u1ef1 tr\u00ean thay \u0111\u1ed5i gi\u00e1 tr\u1ecb RAB_PSCAN_LEVEL sang gi\u00e1 tr\u1ecb mong mu\u1ed1n. Trong b\u00e0i m\u00ecnh ch\u1ecdn gi\u00e1 tr\u1ecb b\u1ea3o m\u1eadt cao nh\u1ea5t l\u00e0 3<\/p>\n<p><span style=\"text-decoration: underline;\">RAB_PSCAN_LEVEL=&#8221;3&#8243;<\/span><\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-4.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-805\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-4-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-4\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-4-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-4.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>Thay \u0111\u1ed5i gi\u00e1 tr\u1ecb IG_TCP_CPORTS: Tham s\u1ed1 n\u00e0y cho ph\u00e9p b\u00ean ngo\u00e0i c\u00f3 th\u1ec3 truy c\u1eadp server qua port n\u00e0o. Trong b\u00e0i m\u00ecnh c\u1ea5u h\u00ecnh t\u01b0\u1eddng l\u1eeda cho ph\u00e9p truy c\u1eadp port 2200, 80, 443<\/p>\n<p><span style=\"text-decoration: underline;\">IG_TCP_CPORTS=&#8221;2200,80,443&#8243;<\/span><\/p>\n<p>T\u01b0\u01a1ng t\u1ef1 cho c\u00e1c port UDP n\u1ebfu c\u00f3 y\u00eau c\u1ea7u<\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-5.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-806\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-5-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-5\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-5-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-5.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p><span style=\"text-decoration: underline;\">EG_TCP_CPORTS:<\/span> thay \u0111\u1ed5i c\u00e1c port cho ph\u00e9p server truy c\u1eadp ra b\u00ean ngo\u00e0i<\/p>\n<p>T\u01b0\u01a1ng t\u1ef1 cho c\u00e1c port UDP<\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-6.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-807\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-6-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-6\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-6-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-6.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>Thay \u0111\u1ed5i gi\u00e1 tr\u1ecb<br \/>\n<span style=\"text-decoration: underline;\">DLIST_PHP=&#8221;1&#8243;<\/span><\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-7.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-808\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-7-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-7\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-7-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-7.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p><span style=\"text-decoration: underline;\">DLIST_SPAMHAUS=&#8221;1&#8243;<\/span><\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-8.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-809\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-8-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-8\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-8-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-8.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p><span style=\"text-decoration: underline;\">DLIST_DSHIELD=&#8221;1&#8243;<\/span><\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-9.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-810\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-9-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-9\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-9-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-9.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>Sau khi \u0111\u00e3 thay \u0111\u1ed5i c\u00e1c gi\u00e1 tr\u1ecb nh\u01b0 \u00fd mu\u1ed1n, \u0111\u1ebfn l\u00fac c\u1ea7n cho ph\u00e9p APF ch\u1ea1y v\u0129nh vi\u1ec5n.<\/p>\n<p><span style=\"text-decoration: underline;\">DEVEL_MODE=0<\/span><\/p>\n<p>M\u1eb7c \u0111\u1ecbnh b\u1eb1ng 1 cho ph\u00e9p APF t\u1ef1 \u0111\u1ed9ng t\u1eaft firewall sau m\u1ed7i 5 ph\u00fat, do \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 truy c\u1eadp c\u00e1c d\u1ecbch v\u1ee5 n\u1ebfu c\u1ea5u h\u00ecnh sai thay v\u00ec b\u1ecb ch\u1eb7n lu\u00f4n.<\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-10.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-811\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-10-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-10\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-10-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-10.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>G\u00f5 l\u1ec7nh<\/p>\n<p style=\"padding-left: 30px;\"><em>apf -s<\/em><\/p>\n<p>\u0111\u1ec3 b\u1eaft \u0111\u1ea7u ch\u1ea1y Advanced Policy Firewall<\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-11.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-812\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-11-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-11\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-11-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-11.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>\u0110\u1ec3 APF t\u1ef1 \u0111\u1ed9ng ch\u1ea1y khi server kh\u1edfi \u0111\u1ed9ng ch\u00fang ta g\u00f5 l\u1ec7nh<\/p>\n<p style=\"padding-left: 30px;\"><em>chkconfig apf on<\/em><\/p>\n<p><a href=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-12.png\" rel=\"lightbox[799]\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-medium wp-image-813\" src=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-12-620x396.png\" alt=\"6-Secure-CentOS-VPS-APF-12\" width=\"620\" height=\"396\" srcset=\"http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-12-620x396.png 620w, http:\/\/vmblogs.vn\/wp-content\/uploads\/2014\/12\/6-Secure-CentOS-VPS-APF-12.png 724w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>B\u1ea3o m\u1eadt t\u01b0\u1eddng l\u1eeda v\u1edbi APF (Advanced Policy Firewall) Trong ph\u1ea7n tr\u01b0\u1edbc ch\u00fang ta \u0111\u00e3 n\u00f3i v\u1ec1 v\u1ea5n \u0111\u1ec1 b\u1ea3o m\u1eadt SSH, tuy nhi\u00ean ch\u1ec9 m\u1ed9t m\u00ecnh SSH th\u00f4i l\u00e0 kh\u00f4ng \u0111\u1ee7, t\u01b0\u1eddng l\u1eeda c\u0169ng r\u1ea5t quan tr\u1ecdng. T\u01b0\u1eddng l\u1eeda \u0111\u00f3ng vai tr\u00f2 l\u00e1 ch\u1eafn cho server c\u1ee7a b\u1ea1n tr\u00e1nh kh\u1ecfi c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng <a class=\"more-link\" href=\"http:\/\/vmblogs.vn\/bao-mat-tuong-lua-voi-apf\/\">Read More &#8230;<\/a><\/p>\n","protected":false},"author":1,"featured_media":775,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[116],"tags":[109,111,115],"_links":{"self":[{"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/posts\/799"}],"collection":[{"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/comments?post=799"}],"version-history":[{"count":0,"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/posts\/799\/revisions"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/media\/775"}],"wp:attachment":[{"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/media?parent=799"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/categories?post=799"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/vmblogs.vn\/wp-json\/wp\/v2\/tags?post=799"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}